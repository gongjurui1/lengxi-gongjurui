var domainName=".wangjiu.com";var authenticationUrl="http://authentication.wangjiu.com";var cpsSecendsJson={C_yiqifa_:3600*24*30};String.prototype.startWith=function(b){var a=new RegExp("^"+b);return a.test(this)};function getCpsSecends(b){var a=3600*24;for(var c in cpsSecendsJson){if(b.startWith(c)){a=cpsSecendsJson[c];break}}return a}function Trim(d){d=replaceNullOrUndifined(d);var c=0;var b=0;var a=d.length;for(c=0;c<a&&d.charAt(c)==" ";c++){}for(b=a;b>1&&d.charAt(b-1)=="  ";b--){}if(c>b){return""}return d.substring(c,b)}function TrimQuotationMarks(c){c=replaceNullOrUndifined(c);var b=0;var a=c.length;if(c.charAt(a-1)=='"'){a--}if(c.charAt(0)=='"'){b++}if(b>a){return""}return c.substring(b,a)}function setCookies(a){for(var b in a){if(b.indexOf("COOKIE")!=-1){addCookie(b,a[b],a.TINMEOUT)}}}function getCookie(h){try{var g=document.cookie.split(";");var a=g.length;if(a<=0){return null}var f=Trim(h);for(var d=0;d<a;d++){if(typeof g[d]=="undefined"||g[d]==""){continue}var b=g[d].split("=");var c=Trim(b[0]);if(c==f){return decodeURIComponent(TrimQuotationMarks(Trim(b[1]))).replace(/%20/g," ")}}}catch(j){}return null}function deleteCookie(a){document.cookie=null;addCookie("COOKIE_SESSION_ID","",-1);addCookie("COOKIE_TOKEN_ID","",-1);addCookie("COOKIE_S_TOKEN_ID","",-1);addCookie("COOKIE_USER_ID","",-1);addCookie("COOKIE_USER_NAME","",-1);addCookie("COOKIE_NICKNAME","",-1);addCookie("COOKIE_USER_LEVEL_ID","",-1);addCookie("COOKIE_TOKEN_DATE","",-1);addCookie("COOKIE_USER_IP","",-1);addCookie("COOKIE_USER_CITY","",-1);addCookie("COOKIE_BIND_FLAG","",-1);if(a==true){addCookie("COOKIE_CPS_ID","",-1)}addCookie("COOKIE_SESSION_ID","",-1,false,"web.wangjiu.com");addCookie("COOKIE_TOKEN_ID","",-1,false,"web.wangjiu.com");addCookie("COOKIE_S_TOKEN_ID","",-1,false,"web.wangjiu.com");addCookie("COOKIE_USER_ID","",-1,false,"web.wangjiu.com");addCookie("COOKIE_USER_NAME","",-1,false,"web.wangjiu.com");addCookie("COOKIE_NICKNAME","",-1,false,"web.wangjiu.com");addCookie("COOKIE_USER_LEVEL_ID","",-1,false,"web.wangjiu.com");addCookie("COOKIE_TOKEN_DATE","",-1,false,"web.wangjiu.com");addCookie("COOKIE_USER_IP","",-1,false,"web.wangjiu.com");addCookie("COOKIE_USER_CITY","",-1,false,"web.wangjiu.com");addCookie("COOKIE_BIND_FLAG","",-1,false,"web.wangjiu.com");if(a==true){addCookie("COOKIE_CPS_ID","",-1,false,"web.wangjiu.com")}}function clearCookie(){var b=document.cookie.match(/[^ =;]+(?=\=)/g);if(b){for(var a=b.length;a--;){document.cookie=b[a]+"=0;expires="+new Date(0).toUTCString()}}}function addCookie(g,a,d,f,e){var h=g+"="+encodeURIComponent(a);if(d!=0){var c=new Date();var b=d*1000;c.setTime(c.getTime()+b);h+="; expires="+c.toGMTString()}h+="; path=/";if(e==null||e==typeof("undifined")){h+="; domain="+domainName}else{h+="; domain="+e}if(typeof f!="undefined"&&f){h+="; secure"}document.cookie=h}function getLinkData(a,c){if(c==2){return""}if(c==1||a.indexOf(domainName)==-1||document.domain.indexOf(domainName)==-1){var b="COOKIE_TOKEN_ID="+SessionObj.Token_ID+"&COOKIE_USER_NAME="+SessionObj.User_Name+"&COOKIE_NICKNAME="+SessionObj.NickName+"&COOKIE_TOKEN_DATE="+SessionObj.Token_Date+"&COOKIE_USER_ID="+SessionObj.User_ID+"&COOKIE_SESSION_ID="+SessionObj.Session_ID+"&COOKIE_USER_LEVEL_ID="+SessionObj.User_Level_ID;return b}return""}function WriteResult(a){var b=a.result[0];if(a.result){SessionObj.Session_ID=replaceNullOrUndifined(b.COOKIE_SESSION_ID);SessionObj.Token_ID=replaceNullOrUndifined(b.COOKIE_TOKEN_ID);SessionObj.S_Token_ID=replaceNullOrUndifined(b.COOKIE_S_TOKEN_ID);SessionObj.User_ID=replaceNullOrUndifined(b.COOKIE_USER_ID);SessionObj.Token_Date=replaceNullOrUndifined(b.COOKIE_TOKEN_DATE);SessionObj.User_IP=replaceNullOrUndifined(b.COOKIE_USER_IP);SessionObj.User_City=replaceNullOrUndifined(b.COOKIE_USER_CITY);SessionObj.User_Name=replaceNullOrUndifined(b.COOKIE_USER_NAME);SessionObj.NickName=replaceNullOrUndifined(b.COOKIE_NICKNAME);SessionObj.User_Level_ID=replaceNullOrUndifined(b.COOKIE_USER_LEVEL_ID);SessionObj.Bind_Flag=replaceNullOrUndifined(b.COOKIE_BIND_FLAG);if(document.domain.indexOf(domainName)==-1){addCookie("COOKIE_SESSION_ID",SessionObj.Session_ID,b.COOKIE_TIMEOUT);addCookie("COOKIE_TOKEN_ID",SessionObj.Token_ID,b.COOKIE_TIMEOUT);addCookie("COOKIE_S_TOKEN_ID",SessionObj.S_Token_ID,b.COOKIE_TIMEOUT,true);addCookie("COOKIE_TOKEN_DATE",SessionObj.Token_Date,b.COOKIE_TIMEOUT);addCookie("COOKIE_USER_IP",SessionObj.User_IP,b.COOKIE_TIMEOUT);addCookie("COOKIE_USER_CITY",SessionObj.User_City,b.COOKIE_TIMEOUT);addCookie("COOKIE_USER_ID",SessionObj.User_ID,b.COOKIE_TIMEOUT);addCookie("COOKIE_USER_NAME",SessionObj.User_Name,b.COOKIE_TIMEOUT);addCookie("COOKIE_NICKNAME",SessionObj.NickName,b.COOKIE_TIMEOUT);addCookie("COOKIE_USER_LEVEL_ID",SessionObj.User_Level_ID,b.COOKIE_TIMEOUT);addCookie("COOKIE_BIND_FLAG",SessionObj.Bind_Flag,b.COOKIE_TIMEOUT)}}SessionObj.IsLinkSuccess=true}function replaceNullOrUndifined(a){if(a==null||typeof a=="undefined"){return""}return a}var SessionObj=new Object();SessionObj.Session_ID=getCookie("COOKIE_SESSION_ID");SessionObj.Token_ID=getCookie("COOKIE_TOKEN_ID");SessionObj.User_ID=getCookie("COOKIE_USER_ID");SessionObj.User_Name=getCookie("COOKIE_USER_NAME");SessionObj.NickName=getCookie("COOKIE_NICKNAME");SessionObj.User_Level_ID=getCookie("COOKIE_USER_LEVEL_ID");SessionObj.Token_Date=getCookie("COOKIE_TOKEN_DATE");SessionObj.User_IP=getCookie("COOKIE_USER_IP");SessionObj.User_City=getCookie("COOKIE_USER_CITY");SessionObj.Bind_Flag=getCookie("COOKIE_BIND_FLAG");SessionObj.linkData="";var curDate=new Date();var curMSecond=curDate.getMilliseconds();var bNeedExtend=false;var newCPSID="";var oldCPS=getCookie("COOKIE_CPS_ID");if(getParameterByName("cps_id")){newCPSID=getParameterByName("cps_id");if(!newCPSID.startWith("FL_")){newCPSID="C_"+newCPSID}}else{if(document.referrer.indexOf("sso.letv.com")==-1&&document.referrer&&(!oldCPS||!oldCPS.startWith("C_"))){newCPSID="W_"+document.referrer.replace("http://","");if(newCPSID.indexOf("/")>0){newCPSID=newCPSID.split("/")[0]}if(newCPSID.indexOf("wangjiu")>0){newCPSID=null}}}if(newCPSID){if(!oldCPS||oldCPS!=newCPSID){if(newCPSID.length>255){newCPSID=newCPSID.substring(0,254)}addCookie("COOKIE_CPS_ID",newCPSID,60*60*24);var secends=getCpsSecends(newCPSID);getJSONP(authenticationUrl+"/api/web/update/getCpsInfo.jsonp?cps_id="+newCPSID.substring(2),"updCpsCookieTime")}}function updCpsCookieTime(a){var b=a.result[0];if(b&&b.VALID_TIME){addCookie("COOKIE_CPS_ID",newCPSID,b.VALID_TIME)}}function getParameterByName(b){var a=RegExp("[?&]"+b+"=([^&]*)").exec(window.location.search);return a&&decodeURIComponent(a[1].replace(/\+/g," "))}if((SessionObj.Token_Date-curMSecond<3600000)&&(SessionObj.User_ID==null||SessionObj.User_ID=="")){bNeedExtend=true}if(SessionObj.Session_ID==null||SessionObj.Session_ID==""||SessionObj.Token_ID==null||SessionObj.Token_ID==""||SessionObj.Token_Date==null||SessionObj.Token_Date==""||SessionObj.User_IP==null||SessionObj.User_IP==""||SessionObj.User_Level_ID==null||SessionObj.User_Level_ID==""||bNeedExtend){SessionObj.IsLinkSuccess=false;generateSessionJSONP(authenticationUrl+"/api/list/generateSession.jsonp?IS_PHONE=0&a="+Math.random())}function generateSessionJSONP(a){var b=document.createElement("script");b.type="text/javascript";b.src=a+"&callback=WriteResult";document.getElementsByTagName("head")[0].appendChild(b)}function getJSONP(a,c){var b=document.createElement("script");b.type="text/javascript";b.src=a+"&callback="+c;document.getElementsByTagName("head")[0].appendChild(b)};