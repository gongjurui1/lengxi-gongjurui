var defaultKeyword="帝王蟹";$("#searchContent").val(defaultKeyword);function initSearch(){selectTip();if($("#searchContent").val()==""){$("#searchContent").val(defaultKeyword)}$("#searchContent").focus(function(){if($(this).val()==defaultKeyword){$(this).val("").attr("style","color:black;")}document.onkeydown=function(b){var a=document.all?window.event:b;if(a.keyCode==13){searchTopByKeyword()}}}).blur(function(){if($(this).val()==""){$(this).val(defaultKeyword).attr("style","color:#999;")}document.onkeydown=function(b){var a=document.all?window.event:b;if(a.keyCode==13){}}})}function searchTopByKeyword(){var b=$.trim($("#searchContent").val().TextFilter());var a=("-keyword-"+b);if(b.length){window.location.href="/product/shoppingmall"+a+".html"}}function selectTip(){$("#searchContent").bind("focus input propertychange",function(){var _self=this;if($(this).val().length===0){$("#searchTip").remove();return}Js.sendData(sendLink.serh+"product/productfacet","pagecount=5&result_type=jsonp&keyword="+$(this).val(),function(data){$("#searchTip").remove();if(data.status=="1"&&data.result.length){var searchItem="",currentItem=-1,allItemCount=data.result.length;for(var i=0;i<allItemCount;i++){if(i>10){continue}var name=data.result[i].chinese;var num=data.result[i].count||"";name=name.replace(eval("/"+$(_self).val()+"/i"),"<b style='color:#b20e61'>"+$(_self).val()+"</b>");searchItem+="<a href='/product/shoppingmall-product_type-1-keyword-"+data.result[i].chinese+".html'><li data-info="+i+">"+name+"<span style='float:right; color:#b20e61;'>约"+num+"件</span></li></a>"}$(_self).parent().append('<ul id="searchTip" class="search-s">'+searchItem+"</ul>");$(_self).unbind("keydown").keydown(function(event){if(event.keyCode==38){currentItem=currentItem>0?(currentItem-1):allItemCount-1}else{if(event.keyCode==40){currentItem=currentItem<allItemCount-1?(currentItem+1):0}else{if(event.keyCode==13){window.location.href="/product/shoppingmall-product_type-1-keyword-"+data.result[currentItem].chinese+".html";return}else{return}}}$(_self).val(data.result[currentItem].chinese);$("#searchTip .sel").removeClass("sel");$("#searchTip li:eq("+currentItem+")").attr("class","sel")});$("#closeSelect").unbind("click").click(function(){$("#searchTip").remove()});$("#searchTip li").unbind("mouseenter").mouseenter(function(){$("#searchTip .sel").removeClass("sel");$(this).addClass("sel");currentItem=parseInt($(this).attr("data-info"),10)}).unbind("mouseleave").mouseleave(function(){$(this).removeClass("sel")})}})}).blur(function(){Js.Tools.pointerInElement("#searchTip",{callback:function(flag){if(flag===false){$("#searchTip").remove()}}})})}String.prototype.TextFilter=function(){var c=new RegExp("[`~%!@#^=''?~！@#￥……&——‘”“'？*()（），,。.、/;]");var a="";for(var b=0;b<this.length;b++){a+=this.substr(b,1).replace(c,"")}return a};